<nav class="navbar-superior">
    <div class="logo-container">
       
        <img src="/Imegenes/pleca_educacion_dic24.png" alt="Logo de Educación">
        <img src="/Imegenes/pleca_tecnm.jpg" alt="Logo de TecNM">
        <img src="/Imegenes/Imagen1.png" alt="Logo de Chiapas">
    </div>
</nav>

<nav class="navbar-inferior">
    <div class="titulo-navbar">
        Eventos 
    </div>
</nav>

<div class="contenedor-vista">
    
    <header class="header-vista">
        <h2>Eventos Registrados</h2>
        <button class="btn-accion-principal btn-refrescar" (click)="cargarEventos()">
            <svg viewBox="0 0 512 512" width="16" height="16"><path fill="white" d="M105.1 202.6c11.9-25.6 44.5-31.4 69.1-17l17.4 9.8 1.4 2.5 17.1-9.6c11.9-6.7 25.9-5.1 36.9 4.3l70 60.1 2.3 2 17.5-9.8c24.6-14.1 57.2-8.3 69.1 17l1.7 3.6 3.6-1.7c25.6-11.9 31.4-44.5 17-69.1l-9.8-17.4-2.5-1.4 9.6-17.1c6.7-11.9 5.1-25.9-4.3-36.9L392.3 84.8l-2-2-17.5 9.8c-24.6 14.1-57.2 8.3-69.1-17l-1.7-3.6-3.6 1.7c-25.6 11.9-31.4 44.5-17 69.1l9.8 17.4 2.5 1.4-9.6 17.1c-6.7 11.9-5.1 25.9 4.3 36.9L184.8 427.2l2 2 17.5-9.8c24.6-14.1 57.2-8.3 69.1 17l1.7 3.6 3.6-1.7c25.6-11.9 31.4-44.5 17-69.1l-9.8-17.4-2.5-1.4 9.6-17.1c-6.7 11.9-5.1 25.9-4.3-36.9L107.1 84.8l-2-2-17.5 9.8c-24.6 14.1-57.2 8.3-69.1 17l-1.7 3.6-3.6-1.7c-25.6 11.9-31.4 44.5-17 69.1zM512 256c0 141.4-114.6 256-256 256S0 397.4 0 256 114.6 0 256 0s256 114.6 256 256zm-256 0c0-106-86-192-192-192S64 150 64 256s86 192 192 192 192-86 192-192z"/></svg>
            Actualizar
        </button>
    </header>

    <div *ngIf="cargando" class="estado-panel cargando">Cargando eventos...</div>
    <div *ngIf="errorCarga" class="estado-panel error">{{ errorCarga }}</div>
    <div *ngIf="!cargando && eventos.length === 0 && !errorCarga" class="estado-panel vacio">No hay eventos registrados en la base de datos.</div>

    <div *ngIf="eventos.length > 0" class="eventos-lista">
        
        <div *ngFor="let evento of eventos" class="evento-card tarjeta-horizontal">
            
            <div class="card-media media-horizontal">
                <ng-container *ngIf="evento.rutaImagen; else noImagePlaceholder">
                    <img [src]="obtenerUrlEvidencia(evento.rutaImagen)" 
                            alt="Imagen promocional del evento" 
                            class="imagen-promocional">
                </ng-container>
                <ng-template #noImagePlaceholder>
                    <div class="placeholder-media media-default">
                        <svg viewBox="0 0 24 24" width="40" height="40"><path fill="#003b6f" d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 11l4.5 6H5l3.5-4.5z"/></svg>
                        <span>Banner No Disponible</span>
                    </div>
                </ng-template>
            </div>
            
            <div class="card-content content-principal">
                <h3 class="card-title">{{ evento.nombre }}</h3>
                
                <div class="meta-data-group">
                    <span class="card-tipo badge-institucional">{{ evento.tipo }}</span>
                    <p class="meta-item">
                        <svg class="icon-detalle" viewBox="0 0 24 24"><path d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11zM5 7V6h14v1H5z"/></svg> 
                        <span class="label-detalle">Fecha:</span> {{ evento.fechaInicio }}
                    </p>
                    <p class="meta-item">
                        <svg class="icon-detalle" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg> 
                        <span class="label-detalle">Lugar:</span> {{ evento.lugar }}
                    </p>
                    <p class="meta-item">
                        <svg class="icon-detalle" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg> 
                        <span class="label-detalle">Organiza:</span> {{ evento.organizador }}
                    </p>
                </div>
                
                <h4 class="objetivo-resumen">Objetivo Principal:</h4>
                <p class="resumen-texto">{{ evento.objetivo }}</p>

                <div class="detalles-principales-ocultos">
                    <h4 class="objetivo-resumen">Público y Ponentes:</h4>
                    <p class="resumen-texto"><strong>Público:</strong> {{ evento.publicoObjetivo }}</p>
                    <p class="resumen-texto"><strong>Ponentes:</strong> {{ evento.ponentes }}</p>
                    <p class="resumen-texto"><strong>Requisitos:</strong> {{ evento.requisitos }}</p>
                </div>

            </div>
            
            <div class="card-actions-area">
                
                <a *ngIf="evento.enlaceExterno" 
                   [href]="evento.enlaceExterno" 
                   target="_blank" 
                   class="btn-accion-secundario btn-social-link" 
                   title="Ver Publicación Externa">
                   <svg viewBox="0 0 24 24" width="16" height="16"><path fill="#003b6f" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 16H8v-2h3v2zm3-4h-3v-2h3v2zm3-4h-3V8h3v2z"/></svg>
                   Ver Publicación
                </a>

                <button *ngIf="evento.rutaEvidencia"
                    (click)="visualizarDocumento(evento)" 
                    class="btn-accion-principal btn-visualizar-doc" 
                    title="Visualizar presentación o documento en el navegador">
                    <svg viewBox="0 0 24 24" width="16" height="16"><path fill="white" d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm-4 13V9h4v6h-4z"/></svg>
                    Visualizar Documento
                </button>
                
                <button *ngIf="evento.rutaEvidencia"
                    (click)="downloadFile(evento)" 
                    class="btn-accion-secundario btn-descarga-doc" 
                    title="Descargar presentación o documento">
                    <svg viewBox="0 0 24 24" width="16" height="16"><path fill="#003b6f" d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    Descargar Evidencia
                </button>
                <p *ngIf="!evento.rutaEvidencia" class="sin-documento">Sin Evidencia Adjunta</p>
                
                <details class="detalle-extendido">
                    <summary class="btn-accion-secundario btn-programa">Ver Programa Completo</summary>
                    <div class="details-content-expandido">
                        <p class="programa-text"><strong>Programa:</strong> {{ evento.programa }}</p>
                        <p class="programa-text"><strong>Materiales:</strong> {{ evento.materiales }}</p>
                    </div>
                </details>

            </div>
            
        </div>
    </div>
</div>